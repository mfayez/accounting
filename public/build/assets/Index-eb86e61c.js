import{D as q,a as J,A as F}from"./AppLayout-1a839f95.js";import{F as M}from"./inertiajs-tables-laravel-query-builder.es-5f1eef6b.js";import x from"./AddEdit-b7c02d6a.js";import{C as L}from"./Confirm-41f29a5d.js";import{J as O}from"./Label-9c529059.js";import W from"./Preview-5fd32342.js";import Q from"./UpdateReceived-4bfa8de6.js";import z from"./CreditNote-5d50eb01.js";import K from"./DebitNote-47a74579.js";import{J as G}from"./SecondaryButton-0e4a566a.js";import{J as H}from"./Button-c7c1269f.js";import{J as X}from"./DangerButton-cae1aa00.js";import{s as g}from"./sweetalert.min-cf20c789.js";import{r as u,o as v,b as Y,w as r,e as l,j as d,Q as Z,d as c,t as a,K as A,f as h,h as b,F as w,v as _,k as V,g as p,n as $}from"./app-a7c937a1.js";import{_ as ee}from"./_plugin-vue_export-helper-c27b6911.js";import"./Edit-01bde3d2.js";import"./ActionMessage-86d2cefe.js";import"./ActionSection-96b34f83.js";import"./SectionTitle-57156eee.js";import"./ConfirmationModal-fc660ee4.js";import"./Modal-d0d07394.js";import"./DialogModal-9ccdd4ea.js";import"./FormSection-fba54185.js";import"./Input-fd3ff2e6.js";import"./Checkbox-f9be08cc.js";import"./InputError-147afb17.js";import"./SectionBorder-790e6c81.js";import"./ValidationErrors-62fdbd60.js";import"./Edit-a799b6f6.js";import"./Edit-1ec525ac.js";import"./vue3-multiselect.umd.min-18b68693.js";/* empty css                                                                  */import"./Load-131c55d3.js";import"./Load-1a88fc17.js";import"./Edit-0cd1ee03.js";import"./Upload-c519c160.js";import"./Upload-feb55a03.js";import"./Settings-519853de.js";import"./Settings-4bb87828.js";import"./Upload-aed85c43.js";import"./Request-bff86671.js";import"./TextField-0eb10881.js";import"./Add-1c7e008b.js";import"./Load-051be2ee.js";import"./Upload-9760ab9e.js";import"./Load-47d081ba.js";import"./ItemsMap-75bf1f86.js";import"./Upload-259c1194.js";import"./Upload-84201142.js";import"./ItemsMap-d1e6a413.js";import"./RequestEx-1ce14a12.js";const te={components:{Dropdown:q,DropdownLink:J,AppLayout:F,Confirm:L,PreviewInvoice:W,UpdateReceived:Q,CreditNote:z,DebitNote:K,JetLabel:O,Table:M,JetButton:H,JetDangerButton:X,AddEditItem:x,SecondaryButton:G},props:{items:Object},data(){return{invItem:{quantity:1009},cancelReason:"",allChecked:!1,notSortableCols:["statusReason","receiver.name","receiver.receiver_id","issuerName","receiverId","receiverName"]}},methods:{openExternal2(e){window.open(route("eta.invoice.download",{uuid:e.uuid}),"_blank")},openExternal(e){window.open(this.$page.props.preview_url+e.uuid+"/share/"+e.longId)},downloadPDF(e){this.invItem=e,window.open(route("pdf.invoice.preview",[e.Id]))},editInvoice(e){this.invItem=e,window.location.href=route("invoices.edit",[e.Id])},viewInvoice(e){this.invItem=e,this.$nextTick(()=>{this.$refs.dlg3.ShowDialog()})},ApproveItem(e){g({title:this.__("Are you sure?"),text:this.__("Once approved it will be sent to ETA"),icon:"warning",buttons:!0,dangerMode:!0}).then(o=>{o&&axios.post(route("eta.invoices.approve"),{Id:e.Id}).then(n=>{g(this.__("Invoice has been approved!"),{icon:"success"}).then(()=>{location.reload()})}).catch(n=>{g(n.response.data,{icon:"error"})})})},creditNoteUpdate(e){this.invItem=e,this.$nextTick(()=>{this.$refs.dlg5.ShowDialog()})},debitNoteUpdate(e){this.invItem=e,this.$nextTick(()=>{this.$refs.dlg6.ShowDialog()})},deleteInvoice(e){this.invItem=e,this.$refs.dlg4.ShowModal()},deleteInv(){axios.post(route("eta.invoices.delete"),{Id:this.invItem.Id}).then(e=>{location.reload()}).catch(e=>{alert(e.response.data)})},cancelInvoice(e){this.invItem=e,this.$refs.dlg2.ShowModal()},cancelInv2(){axios.post(route("eta.invoices.cancel"),{uuid:this.invItem.uuid,status:"cancelled",reason:this.cancelReason}).then(e=>{console.log(e),alert(e.data)}).catch(e=>{console.log(e),alert(e.response.data)})},checkAll(){this.$nextTick(()=>{this.items.data.forEach(e=>{e.selected=this.allChecked})})},ApproveSelected(){var e=this.items.data.filter(o=>o.selected).map(o=>o.Id);if(e.length==0){g(this.__("Please select at least one invoice!"),{icon:"error"});return}g({title:this.__("Are you sure?"),text:this.__("Once approved it will be sent to ETA"),icon:"warning",buttons:!0,dangerMode:!0}).then(o=>{o&&axios.post(route("eta.invoices.approve"),{Id:this.items.data.filter(n=>n.selected).map(n=>n.Id)}).then(n=>{g(this.__("Invoices has been approved!"),{icon:"success"}).then(()=>{location.reload()})}).catch(n=>{g(n.response.data,{icon:"error"})})})},alignDropDown(){return this.$page.props.locale=="en"?"left":"right"},render_status:function(e,o){return e.cancelRequestDate&&e.status!="Cancelled"?this.__("Cancel Pending"):e.rejectRequestDate&&e.status!="Rejected"?this.__("Reject Pending"):this.__(o)},nestedIndex:function(e,o){try{var n=o.split(".");return n.length==1?e[o].toString():n.length==2?e[n[0]][n[1]].toString():n.length==3?e[n[0]][n[1]][n[2]].toString():"Unsupported Nested Index"}catch{}return"N/A"},editItem:function(e){}}},oe=["value"],ne=["value"],le={class:"py-4"},re={class:"mx-auto sm:px-6 lg:px-8"},ie={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-4"},se=["onClick"],ae=["onUpdate:modelValue","value"],de={class:"grid grid-cols-3 w-56"};function ce(e,o,n,B,m,s){const T=u("preview-invoice"),N=u("credit-note"),R=u("debit-note"),D=u("jet-label"),S=u("confirm"),I=u("jet-button"),U=u("dropdown-link"),j=u("dropdown"),y=u("jet-danger-button"),k=u("secondary-button"),E=u("Table"),P=u("app-layout");return v(),Y(P,null,{default:r(()=>[l(T,{ref:"dlg3",modelValue:m.invItem,"onUpdate:modelValue":o[0]||(o[0]=t=>m.invItem=t)},null,8,["modelValue"]),l(N,{ref:"dlg5",modelValue:m.invItem,"onUpdate:modelValue":o[1]||(o[1]=t=>m.invItem=t)},null,8,["modelValue"]),l(R,{ref:"dlg6",modelValue:m.invItem,"onUpdate:modelValue":o[2]||(o[2]=t=>m.invItem=t)},null,8,["modelValue"]),l(S,{ref:"dlg2",onConfirmed:o[4]||(o[4]=t=>s.cancelInv2())},{default:r(()=>[l(D,{for:"type",value:e.__("Select cancelation reason")},null,8,["value"]),d(c("select",{id:"type","onUpdate:modelValue":o[3]||(o[3]=t=>m.cancelReason=t),class:"mt-1 block w-full"},[c("option",{value:e.__("Wrong buyer details")},a(e.__("Wrong buyer details")),9,oe),c("option",{value:e.__("Wrong invoice details")},a(e.__("Wrong invoice details")),9,ne)],512),[[Z,m.cancelReason]])]),_:1},512),l(S,{ref:"dlg4",onConfirmed:o[5]||(o[5]=t=>s.deleteInv())},{default:r(()=>[l(D,{for:"type",value:"Are you sure you want to delete this Invoice?"})]),_:1},512),c("div",le,[c("div",re,[c("div",ie,[l(E,{filters:e.queryBuilderProps.filters,search:e.queryBuilderProps.search,columns:e.queryBuilderProps.columns,"on-update":e.setQueryBuilder,meta:n.items},{head:r(()=>[c("tr",null,[c("th",null,[d(c("input",{type:"checkbox","onUpdate:modelValue":o[6]||(o[6]=t=>m.allChecked=t),onChange:o[7]||(o[7]=t=>s.checkAll())},null,544),[[A,m.allChecked]])]),(v(!0),h(w,null,b(e.queryBuilderProps.columns,(t,i)=>(v(),h(w,{key:i},[m.notSortableCols.includes(i)?d((v(),h("th",{key:0},a(t.label),513)),[[_,e.show(i)]]):d((v(),h("th",{key:1,class:"cursor-pointer",onClick:V(f=>e.sortBy(i),["prevent"])},a(t.label),9,se)),[[_,e.show(i)]])],64))),128)),c("th",null,[l(j,{align:s.alignDropDown(),width:"48",class:"ms-3 mb-3 lg:mb-0"},{trigger:r(()=>[l(I,null,{default:r(()=>[p(a(e.__("Bulk Actions")),1)]),_:1})]),content:r(()=>[l(U,{as:"a",onClick:o[8]||(o[8]=V(t=>s.ApproveSelected(),["prevent"])),href:"#"},{default:r(()=>[p(a(e.__("Approve Selected")),1)]),_:1})]),_:1},8,["align"])])])]),body:r(()=>[(v(!0),h(w,null,b(n.items.data,t=>(v(),h("tr",{key:t.id,class:$({credit:t.documentType=="C",debit:t.documentType=="D"})},[c("td",null,[d(c("input",{type:"checkbox","onUpdate:modelValue":i=>t.selected=i,value:t.id},null,8,ae),[[A,t.selected]])]),(v(!0),h(w,null,b(e.queryBuilderProps.columns,(i,f)=>d((v(),h("td",{key:f},[(v(!0),h(w,null,b(s.nestedIndex(t,f).split(","),C=>(v(),h("div",null,a(f=="status"?s.render_status(t,C):f=="statusReason"?e.__(C):f=="dateTimeIssued"||f=="dateTimeReceived"?new Date(C).toISOString().slice(0,10):C),1))),256))])),[[_,e.show(f)]])),128)),c("td",null,[c("div",de,[d(l(y,{class:"me-2 mt-2",onClick:i=>s.cancelInvoice(t)},{default:r(()=>[p(a(e.__("Cancel")),1)]),_:2},1032,["onClick"]),[[_,t.status=="Valid"]]),d(l(y,{class:"me-2 mt-2",onClick:i=>s.deleteInvoice(t)},{default:r(()=>[p(a(e.__("Delete")),1)]),_:2},1032,["onClick"]),[[_,t.status!="Valid"&&t.status!="approved"&&t.status!="Submitted"]]),d(l(I,{class:"me-2 mt-2",onClick:i=>s.editInvoice(t)},{default:r(()=>[p(a(e.__("Edit")),1)]),_:2},1032,["onClick"]),[[_,["in review","invalid","approved","rejected","cancelled"].indexOf(t.status.toLowerCase())>=0]]),l(k,{class:"me-2 mt-2",onClick:i=>s.viewInvoice(t)},{default:r(()=>[p(a(e.__("View")),1)]),_:2},1032,["onClick"]),d(l(I,{class:"me-2 mt-2",onClick:i=>s.ApproveItem(t)},{default:r(()=>[p(a(e.__("Approve")),1)]),_:2},1032,["onClick"]),[[_,t.status=="In Review"]]),l(I,{class:"me-2 mt-2",onClick:i=>s.downloadPDF(t)},{default:r(()=>[p(a(e.__("PDF")),1)]),_:2},1032,["onClick"]),d(l(k,{class:"me-2 mt-2",onClick:i=>s.openExternal(t)},{default:r(()=>[p(a(e.__("ETA1")),1)]),_:2},1032,["onClick"]),[[_,t.status=="Valid"]]),d(l(I,{class:"me-2 mt-2",onClick:i=>s.openExternal2(t)},{default:r(()=>[p(a(e.__("ETA2")),1)]),_:2},1032,["onClick"]),[[_,t.status=="Valid"]]),d(l(k,{class:"me-2 mt-2",onClick:i=>s.creditNoteUpdate(t)},{default:r(()=>[p(a(e.__("Credit")),1)]),_:2},1032,["onClick"]),[[_,t.status=="Valid"]]),d(l(I,{class:"me-2 mt-2",onClick:i=>s.debitNoteUpdate(t)},{default:r(()=>[p(a(e.__("Debit")),1)]),_:2},1032,["onClick"]),[[_,t.status=="Valid"]])])])],2))),128))]),_:1},8,["filters","search","columns","on-update","meta"])])])])]),_:1})}const at=ee(te,[["render",ce],["__scopeId","data-v-5277c889"]]);export{at as default};
