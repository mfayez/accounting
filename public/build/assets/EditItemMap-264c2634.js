import{J as I}from"./ActionMessage-86d2cefe.js";import{J}from"./ActionSection-96b34f83.js";import{J as A}from"./Button-c7c1269f.js";import{J as E}from"./ConfirmationModal-fc660ee4.js";import{J as N}from"./DangerButton-cae1aa00.js";import{J as D}from"./DialogModal-9ccdd4ea.js";import{J as k}from"./FormSection-fba54185.js";import{J as w}from"./Input-fd3ff2e6.js";import{J as B}from"./Checkbox-f9be08cc.js";import{J as j}from"./InputError-147afb17.js";import{J as U}from"./Label-9c529059.js";import{J as M}from"./SecondaryButton-0e4a566a.js";import{J as L}from"./SectionBorder-790e6c81.js";import{J as F}from"./ValidationErrors-62fdbd60.js";import{M as P}from"./vue3-multiselect.umd.min-18b68693.js";import{r as d,o as f,b,w as m,g as u,t as i,e as a,d as l,f as g,h as W,F as T,i as R,k as q,n as z}from"./app-a7c937a1.js";import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";import"./SectionTitle-57156eee.js";import"./Modal-d0d07394.js";const G={components:{JetActionMessage:I,JetActionSection:J,JetButton:A,JetConfirmationModal:E,JetDangerButton:N,JetDialogModal:D,JetFormSection:k,JetInput:w,JetCheckbox:B,JetInputError:j,JetLabel:U,JetSecondaryButton:M,JetSectionBorder:L,JetValidationErrors:F,Multiselect:P},props:{item_map:{Type:Object,default:null}},data(){return{errors:[],form:this.$inertia.form({SBCode:"",ETACode:"",ItemNameA:"",ItemNameE:"",taxTypes:[],Val_Diff:0}),eta_item:null,items:[],showDialog:!1,taxTypes:[],taxSubTypes:[],taxSubtypes1:[],taxType:null,taxSubtype:null}},methods:{ShowDialog(){this.item_map!==null&&(this.form.SBCode=this.item_map.SBCode,this.form.ETACode=this.item_map.ETACode,this.form.ItemNameA=this.item_map.ItemNameA,this.form.ItemNameE=this.item_map.ItemNameE,this.form.Val_Diff=this.item_map.Val_Diff,this.form.taxTypes=[],this.updateTaxList()),this.showDialog=!0,this.$nextTick(()=>{this.item_map!=null&&this.items!=null&&(this.eta_item=this.items.find(e=>e.itemCode===this.form.ETACode),this.updateETAItem())})},CancelDlg(){this.showDialog=!1},submit(){axios.post(route("sb.items.map.update"),this.form).then(e=>{this.$store.dispatch("setSuccessFlashMessage",!0),this.processing=!1,this.form.reset(),this.form.processing=!1,this.showDialog=!1,setTimeout(()=>{window.location.reload()},500)}).catch(e=>{this.form.processing=!1,this.$page.props.errors=e.response.data.errors,this.errors=e.response.data.errors})},nameWithCode({codeNamePrimaryLang:e,codeNameSecondaryLang:t,itemCode:n}){return this.$page.props.locale=="ar"?n+" - "+t:n+" - "+e},updateETAItem(){this.eta_item&&((this.form.ItemNameA==null||this.form.ItemNameA.length<3)&&(this.form.ItemNameA=this.eta_item.codeNameSecondaryLang),(this.form.ItemNameE==null||this.form.ItemNameE.length<3)&&(this.form.ItemNameE=this.eta_item.codeNamePrimaryLang),this.form.ETACode=this.eta_item.itemCode)},updateTaxSubtypes(){this.taxSubtypes1=this.taxSubtypes.filter(e=>{if(e.TaxtypeReference==this.taxType.Code)return e}),this.taxSubType={}},AddTaxItem(e=0){this.form.taxTypes.push({taxType:this.taxType,taxSubtype:this.taxSubtype,percentage:e})},deleteItem(e){this.form.taxTypes.splice(e,1)},updateTaxList(){this.item_map.item_tax.forEach(e=>{this.taxType=this.taxTypes.find(t=>t.Code===e.taxType),this.taxSubtype=this.taxSubtypes.find(t=>t.Code===e.taxSubtype),this.AddTaxItem(e.rate)})}},created(){axios.get(route("json.eta.items")).then(e=>{this.items=e.data,this.item_map!=null&&(this.eta_item=this.items.find(t=>t.itemCode===this.form.ETACode),this.updateETAItem())}).catch(e=>{}),axios.get("/json/TaxTypes.json").then(e=>{this.taxTypes=e.data,this.taxTypes=this.taxTypes.map(t=>(t.label=t.Code.concat("(",t.Desc_ar,")"),t)),axios.get("/json/TaxSubtypes.json").then(t=>{this.taxSubtypes=t.data,this.taxSubtypes=this.taxSubtypes.map(n=>(n.label=n.Code.concat("(",n.Desc_ar,")"),n)),this.updateTaxList()}).catch(t=>{})}).catch(e=>{})}},H={class:"grid grid-cols-2 gap-4"},K={class:"col-span-1"},Q={class:"col-span-1"},X={class:"col-span-2"},Y={class:"col-span-1"},Z={class:"col-span-1"},$={class:"grid grid-cols-7 gap-2 mt-2 border-t border-b border-gray-20"},ee={class:"flex items-center justify-center col-span-1"},te={class:"grid grid-cols-6 gap-0 mt-2"},se={class:"bg-gray-200 col-span-2"},oe={class:"bg-gray-200 col-span-2"},ae={class:"bg-gray-200 col-span-1"},le=l("div",{class:"bg-gray-200 col-span-1"},null,-1),ie={class:"flex items-center justify-end"};function me(e,t,n,re,o,r){const x=d("jet-validation-errors"),p=d("jet-label"),c=d("jet-input"),h=d("multiselect"),_=d("jet-secondary-button"),S=d("jet-danger-button"),C=d("jet-button"),V=d("jet-dialog-modal");return f(),b(V,{show:o.showDialog,maxWidth:"3xl",onClose:t[10]||(t[10]=s=>o.showDialog=!1)},{title:m(()=>[u(i(e.__("Item Map")),1)]),content:m(()=>[a(x,{class:"mb-4"}),l("form",{onSubmit:t[8]||(t[8]=q((...s)=>r.submit&&r.submit(...s),["prevent"]))},[l("div",H,[l("div",K,[a(p,{value:e.__("SBCode")},null,8,["value"]),a(c,{id:"SBCode",type:"text",class:"mt-1 block w-full",modelValue:o.form.SBCode,"onUpdate:modelValue":t[0]||(t[0]=s=>o.form.SBCode=s),disabled:!0},null,8,["modelValue"])]),l("div",Q,[a(p,{value:e.__("Value Difference")},null,8,["value"]),a(c,{id:"ValDiff",type:"number",class:"mt-1 block w-full",modelValue:o.form.Val_Diff,"onUpdate:modelValue":t[1]||(t[1]=s=>o.form.Val_Diff=s)},null,8,["modelValue"])]),l("div",X,[a(p,{value:e.__("ETACode")},null,8,["value"]),a(h,{modelValue:o.eta_item,"onUpdate:modelValue":[t[2]||(t[2]=s=>o.eta_item=s),r.updateETAItem],options:o.items,"custom-label":r.nameWithCode,label:"codeNamePrimaryLang","track-by":"itemCode",placeholder:e.__("Select item")},null,8,["modelValue","options","custom-label","onUpdate:modelValue","placeholder"])]),l("div",Y,[a(p,{value:e.__("Name Arabic")},null,8,["value"]),a(c,{id:"SBCode",type:"text",class:"mt-1 block w-full",modelValue:o.form.ItemNameA,"onUpdate:modelValue":t[3]||(t[3]=s=>o.form.ItemNameA=s)},null,8,["modelValue"])]),l("div",Z,[a(p,{value:e.__("Name English")},null,8,["value"]),a(c,{id:"SBCode",type:"text",class:"mt-1 block w-full",modelValue:o.form.ItemNameE,"onUpdate:modelValue":t[4]||(t[4]=s=>o.form.ItemNameE=s)},null,8,["modelValue"])])]),l("div",$,[a(h,{class:"col-span-3",modelValue:o.taxType,"onUpdate:modelValue":[t[5]||(t[5]=s=>o.taxType=s),r.updateTaxSubtypes],label:"label",placeholder:e.__("Select Tax Type"),options:o.taxTypes},null,8,["modelValue","placeholder","options","onUpdate:modelValue"]),a(h,{class:"col-span-3",modelValue:o.taxSubtype,"onUpdate:modelValue":t[6]||(t[6]=s=>o.taxSubtype=s),placeholder:e.__("Select Tax Subtype"),options:o.taxSubtypes1,label:"label"},null,8,["modelValue","placeholder","options"]),l("div",ee,[a(_,{onClick:t[7]||(t[7]=s=>r.AddTaxItem())},{default:m(()=>[u(i(e.__("Add Tax")),1)]),_:1})])]),l("div",te,[l("div",se,i(e.__("Tax Code")),1),l("div",oe,i(e.__("Tax Subcode")),1),l("div",ae,i(e.__("Tax Percentage")),1),le,(f(!0),g(T,null,W(o.form.taxTypes,(s,v)=>(f(),g(T,{key:s.key},[a(p,{class:"mt-2 col-span-2"},{default:m(()=>[u(i(s.taxType.label),1)]),_:2},1024),a(p,{class:"mt-2 col-span-2"},{default:m(()=>[u(i(s.taxSubtype.label),1)]),_:2},1024),a(c,{id:s.taxType.label,type:"number",class:"mt-1 block w-full mt-2 col-span-1",isRounded:!1,modelValue:s.percentage,"onUpdate:modelValue":y=>s.percentage=y,required:"",autofocus:""},null,8,["id","modelValue","onUpdate:modelValue"]),a(S,{onClick:y=>r.deleteItem(v),class:"mt-2 ms-2"},{default:m(()=>[u(i(e.__("Delete")),1)]),_:2},1032,["onClick"])],64))),128)),!o.form.taxTypes||o.form.taxTypes.length==0?(f(),b(p,{key:0,class:"col-span-8"},{default:m(()=>[u(i(e.__("Please Add tax items if applicable")),1)]),_:1})):R("",!0)])],32)]),footer:m(()=>[l("div",ie,[a(_,{onClick:t[9]||(t[9]=s=>r.CancelDlg())},{default:m(()=>[u(i(e.__("Cancel")),1)]),_:1}),a(C,{class:z(["ms-2",{"opacity-25":o.form.processing}]),onClick:r.submit,disabled:o.form.processing},{default:m(()=>[u(i(e.__("Save")),1)]),_:1},8,["onClick","class","disabled"])])]),_:1},8,["show"])}const Ae=O(G,[["render",me]]);export{Ae as default};
